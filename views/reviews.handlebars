<div class="reviews-container">
    <h2>My Reviews</h2>
    
    {{#if reviews.length}}
        <div class="reviews-grid">
            {{#each reviews}}
                <div class="review-card">
                    <h3>{{this.mediaTitle}} ({{this.mediaType}})</h3>
                    <p class="review-text">{{this.text}}</p>
                    <div class="review-meta">
                        <span class="rating">Rating: {{this.rating}}/5</span>
                        <span class="date">Posted: {{formatDate this.createdAt}}</span>
                        {{#if this.updatedAt}}
                            <span class="date">(Edited: {{formatDate this.updatedAt}})</span>
                        {{/if}}
                    </div>
                    <div class="review-actions">
                        <a href="/reviews/{{this._id}}/edit" class="edit-btn">Edit Review</a>
                        <button onclick="deleteReview('{{this._id}}')" class="delete-btn">Delete Review</button>
                    </div>
                </div>
            {{/each}}
        </div>
    {{else}}
        <p class="no-reviews">You haven't written any reviews yet.</p>
    {{/if}}
</div>

<script>
function deleteReview(reviewId) {
    if (confirm('Are you sure you want to delete this review?')) {
        fetch(`/reviews/${reviewId}`, {
            method: 'DELETE',
        })
        .then(response => {
            if (response.ok) {
                window.location.reload();
            } else {
                throw new Error('Failed to delete review');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Failed to delete review');
        });
    }
}
</script>
